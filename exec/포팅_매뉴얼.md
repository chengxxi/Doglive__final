# Dog-Live ğŸ’»í¬íŒ… ë§¤ë‰´ì–¼ğŸ’»

> SSAFY 5ê¸° ê³µí†µí”„ë¡œì íŠ¸ ì„œìš¸ 5ë°˜ 1íŒ€ ê²¬ê³¼ë¥˜

[ğŸ’Œë…ë¦½ ì‚¬ìš© ì„¤ëª…ì„œğŸ’Œ](https://www.notion.so/87e8c174f17342488f0fad86493f777e)

<br><br>

## ğŸ“– ëª©ì°¨

[ ğŸ“‘ ê°œë°œ í™˜ê²½ ì„¸íŒ… ](#-ê°œë°œ-í™˜ê²½-ì„¸íŒ…)

[ ğŸ“‘ ê³„ì • ì •ë³´ ](#-ê³„ì •-ì •ë³´)

[ ğŸ“‘ í”„ë¡œí¼í‹° íŒŒì¼ ì •ë³´ ](#-í”„ë¡œí¼í‹°-íŒŒì¼-ëª©ë¡)

[ ğŸ“‘ ë¹Œë“œ ë° ë°°í¬ ë°©ë²• ](#-ë¹Œë“œ-ë°-ë°°í¬-ë°©ë²•)

[ ğŸ“‘ ì™¸ë¶€ ì„œë¹„ìŠ¤ ](#-ì™¸ë¶€-ì„œë¹„ìŠ¤)

<br><br>

## ğŸ›  ê°œë°œ í™˜ê²½ ì„¸íŒ…

- OS : Windows 10

- Server : AWS EC2
    - Ubuntu 20.04.1
    - Docker 20.10.8
<br>

- Backend
    - Java : Java 1.8.0
    - Framework : SpringBoot 2.4.5
    - ORM : JPA(Hibernate)
    - Nginx : 1.18.0 (Ubuntu)
    - IDE : Intellij 2021.1.3 / Visual Studio Code 1.59
    - Dependency tool : gradle-6.7
    - Database : MariaDB-10.3.31
    - Image Server : AWS S3 & CloudFront
<br>

- Frontend
    - HTML5, CSS3, Javascript(Es6)
    - Vue 3.0.0
    - @vue/cli 4.5.0
    - Vuex 4.0.0
    - Vue-axios 3.2.4

<br><br>

## ğŸ”’ ê³„ì • ì •ë³´

- DB ì ‘ì† ì •ë³´
    - ID : dogvlie
    - PW : doglivedoggi

<br>

- Jenkins ì ‘ì† ì •ë³´
    - ID : admin
    - PW : doglivedoggi
    - Jenkins ê´€ë¦¬ì í˜ì´ì§€
        - `http://i5a501.p.ssafy.io:9090` ë¡œ ì ‘ì†
            - ì£¼ì˜ : httpsê°€ ì•„ë‹ˆë¼ **http** ì…ë‹ˆë‹¤!


<br><br>


## ğŸ”‘í”„ë¡œí¼í‹° íŒŒì¼ ëª©ë¡

```bash
backend
â””â”€â”€ src
	â””â”€â”€main
		â””â”€â”€resources
			â”œâ”€â”€ application.yaml
			â””â”€â”€ application-aws.yaml
```

- `application.yaml` (í”„ë¡œì íŠ¸ ì…‹íŒ…, ë°°í¬ ì…‹íŒ…, DB ì…‹íŒ… ì •ë³´)  
- `application-aws.yaml` (S3 ì„œë²„ accessKey, secretKey ì •ë³´)  

<br><br>

## ğŸ“¢ ë¹Œë“œ ë° ë°°í¬ ë°©ë²•

### 1. ë¡œì»¬ ì‹¤í–‰ ê°€ì´ë“œ

1. Project Git Clone : 

    ```bash
    $ git clone https://lab.ssafy.com/s05-webmobile1-sub3/S05P13A501
    ```

<br>

2. Test

    ```bash
    $ cd backend/build/libs
    $ java -jar common-project-1.0-SNAPSHOT.jar
    ```

    `https://localhost:8081` ë¡œ ë“¤ì–´ê°€ì„œ í™•ì¸í•œë‹¤.

<br>

3. IDEë¡œ í”„ë¡œì íŠ¸ Import
    - Intellij ê¸°ì¤€
        - File > New > Project from Existing sources > í”„ë¡œì íŠ¸ ê²½ë¡œ ì„ íƒ > import ë°©ì‹ gradle  
    - í”„ë¡œì íŠ¸ ì‹¤í–‰ : Gradle Project > bootRun  
    - ë¸Œë¼ìš°ì €ì—ì„œ `https://localhost:8081`ë¡œ ì ‘ì†  

    - ë¡œì»¬ ì‹¤í–‰ ì‹œ ë¡œê·¸ì¸ ê¸°ëŠ¥ì„ ì´ìš©í•˜ë ¤ë©´ Redirect URIë¥¼ ë³€ê²½í•´ì£¼ì–´ì•¼, ë¡œê·¸ì¸ í›„ ë¡œì»¬ í˜ì´ì§€ë¡œ Redirectëœë‹¤.  
        (í˜„ì¬ëŠ” ë°°í¬ ì‚¬ì´íŠ¸ë¡œ Redirect ë˜ë„ë¡ ì…‹íŒ…ë˜ì–´ ìˆìŒ)  
 
    - ë¡œì»¬ ì‹¤í–‰ ì‹œ ì±„íŒ… ê¸°ëŠ¥ì„ ì´ìš©í•˜ë ¤ë©´ URIë¥¼ ë³€ê²½í•´ì£¼ì–´ì•¼ ì±„íŒ…ì´ ì›í™œí•˜ê²Œ ì‘ë™ëœë‹¤.  
        (í˜„ì¬ëŠ” ë°°í¬ ì‚¬ì´íŠ¸ ê¸°ì¤€ìœ¼ë¡œ URIê°€ ì…‹íŒ…ë˜ì–´ ìˆìŒ)  

<br><br>

### 2. ë°°í¬ ê°€ì´ë“œ

1. ì§ì ‘ ë¹Œë“œ í›„ ë°°í¬
- í”„ë¡œì íŠ¸ ì§ì ‘ ë¹Œë“œ

    ```bash
    $cd S05P13A501/backend
     $./gradlew clean build
    ```

<br>

- í”„ë¡œì íŠ¸ ì‹¤í–‰

     ```bash
    $cd S05P13A501/backend/build/libs
    $java -jar common-project-1.0-SNAPSHOT.jar
    ```

    `https://i5a501.p.ssafy.io/` ë¡œ ì ‘ì†

<br>

2. Jenkinsë¥¼ ì´ìš©í•œ ìë™ ë¹Œë“œ ë° ë°°í¬
- Jenkins ê´€ë¦¬ì í˜ì´ì§€
    - `http://i5a501.p.ssafy.io:9090` ë¡œ ì ‘ì†
        - ì£¼ì˜ : httpsê°€ ì•„ë‹ˆë¼ **http** ì…ë‹ˆë‹¤!

<br>

- ì§ì ‘ í”„ë¡œì íŠ¸ ì‹¤í–‰

    ```bash
    $cd /var/lib/jenkins/workspace/build/backend/build/libs

    $java -jar common-project-1.0-SNAPSHOT.jar
    ```


<br><br>

## ğŸ“¡ ì™¸ë¶€ ì„œë¹„ìŠ¤

### 1. ì¹´ì¹´ì˜¤ API
  
- ì¹´ì¹´ì˜¤ê³„ì •ê³¼ ë³¸ ì• í”Œë¦¬ì¼€ì´ì…˜ì„ ì—°ê²°í•˜ê³  í† í°ì„ ë°œê¸‰ë°›ì•„ ì¹´ì¹´ì˜¤ APIë¥¼ ì‚¬ìš©    
- ì§ì ‘ ì„œë¹„ìŠ¤ ID ë° ë¹„ë°€ë²ˆí˜¸ë¥¼ ì…ë ¥ë°›ê³  ê²€ì¦í•˜ëŠ” ê³¼ì •ì„ êµ¬í˜„í•˜ëŠ” ëŒ€ì‹ ,  
     ì¹´ì¹´ì˜¤ ë¡œê·¸ì¸ì„ í†µí•´ ì‚¬ìš©ìë¥¼ ì¸ì¦í•˜ê³  íšŒì› ì •ë³´ë¥¼ ìˆ˜ì§‘
- ì¹´ì¹´ì˜¤ APIê°€ ì œê³µë˜ì§€ ì•ŠëŠ” ê°€ì… ë° íƒˆí‡´ ë“± íšŒì› ì •ë³´ì— ëŒ€í•œ ì²˜ë¦¬ëŠ” ì„œë¹„ìŠ¤ì—ì„œ ìì²´ì ìœ¼ë¡œ êµ¬í˜„  

- í™˜ê²½ì„¤ì •

    ```bash
    backend
    â””â”€â”€ src
    	â””â”€â”€java
    		â””â”€â”€resources
    			â””â”€â”€com
    				â””â”€â”€ssafy
    					â””â”€â”€api
    						â””â”€â”€service
    							â””â”€â”€ KakaoAPI.java
    ```

<br>

- `KakaoAPI.java`ì˜ `APPKEY`ë¥¼ ë‚´ ì• í”Œë¦¬ì¼€ì´ì…˜ì˜ REST APIë¡œ ì…‹íŒ…
(ì´ë¯¸ ì…‹íŒ…ë˜ì–´ ìˆìœ¼ë¯€ë¡œ ë³€ê²½í•  í•„ìš” ì—†ë‹¤)  

    - ì¹´ì¹´ì˜¤ ë¡œê·¸ì¸ì„ ìœ„í•œ RESTAPI key
        `bacd72f58ac01490602415c683ad8c05`  

    - ì¹´ì¹´ì˜¤ ê³µìœ í•˜ê¸°ë¥¼ ìœ„í•œ Javascript key 
        `d0106aa9ba1feb9c379bbb82194695fe`  
        
    ![image](/uploads/7e45b46929e0edcb9e0087e2222da08d/image.png)  

<br>

- **ë¡œì»¬ í…ŒìŠ¤íŠ¸** ì‹œ ë¯¸ë¦¬ ì„¤ì •í•´ ë†“ì€ **`redirect URI`**ë¥¼ ë°”ê¿”ì£¼ì–´ì•¼,

    ë¡œê·¸ì¸ í›„ì— ë¡œì»¬ í˜ì´ì§€ë¡œ redirectëœë‹¤.

    (í˜„ì¬ ì„¤ì •ì€ ë°°í¬ í˜ì´ì§€ë¡œ redirect ë˜ë„ë¡ ì…‹íŒ…)

    - **redirect URI** ë³€ê²½ë²•

        1. Backend
            a. KakaoApi.java

            ```bash
                backend
                â””â”€â”€ src
                    â””â”€â”€java
                    	â””â”€â”€resources
                    		â””â”€â”€com
                    			â””â”€â”€ssafy
                    				â””â”€â”€api
                    					â””â”€â”€service
                    						â””â”€â”€ KakaoAPI.java
            ```

            ![image](/uploads/aa478f1c7d1ccc5b984659423dee2431/image.png)

            38, 39ë²ˆ ë¼ì¸ì˜ `redirect_uri`ë¥¼ í˜„ì¬ í™˜ê²½ì— ë§ëŠ” `URI`ë¡œ ë³€ê²½ì‹œì¼œì£¼ê³ , í•´ë‹¹ í•˜ì§€ ì•ŠëŠ” URIëŠ” ì£¼ì„ì²˜ë¦¬í•œë‹¤.

            - `https://i5a501.p.ssafy.io/kakao/callback` : ë°°í¬ìš©

            - `https://localhost:8082/kakao/callback` : ë¡œì»¬í…ŒìŠ¤íŠ¸ìš©

<br>

        2. Frontend
            1. login-dialog.vue

            ```bash
                frontend
                â””â”€â”€ src
                    â””â”€â”€ views
                    	â””â”€â”€ main
                    		â””â”€â”€ login-dialog.vue
            ```

            ![image](/uploads/8747ddd4f7ceaf5bf5fc6a35eec0ad5f/image.png)

             79,80ë²ˆ ë¼ì¸ì˜ `redirectURI`ë¥¼ í˜„ì¬ í™˜ê²½ì— ë§ëŠ” `URI`ë¡œ ë³€ê²½ì‹œì¼œì£¼ê³ , í•´ë‹¹ í•˜ì§€ ì•ŠëŠ” URIëŠ” ì£¼ì„ì²˜ë¦¬í•œë‹¤.

            - `https://i5a501.p.ssafy.io/kakao/callback` : ë°°í¬ìš©  

            - `https://localhost:8082/kakao/callback` : ë¡œì»¬í…ŒìŠ¤íŠ¸ìš©

<br>

- ì¹´ì¹´ì˜¤ ë¡œê·¸ì¸ ë°©ë²•
    - ê°œì¸ì˜ ì¹´ì¹´ì˜¤ ê³„ì •ìœ¼ë¡œ ììœ ë¡­ê²Œ ì„œë¹„ìŠ¤ ì´ìš© ê°€ëŠ¥

        (ê°€ì… ì‹œ ëª¨ë“  ì‚¬í•­ ë™ì˜ ê¶Œì¥)

    - ê³„ì •ì´ ì—†ì„ ì‹œ í•˜ë‹¨ì— ê¸°ì¬í•œ ê³µìš© ì•„ì´ë””ë¡œ ì´ìš© ê¶Œì¥
        - ID : doglivetest@kakao.com
        - PW : ssafy123


<br><br>


### 2. AWS S3 & CloudFront

- AWS S3ì™€ CloudFrontë¥¼ ì—°ë™í•œ ì´ë¯¸ì§€ ì„œë²„ í™œìš©
- í™˜ê²½ ì„¤ì •
    - aws s3 ì„œë²„ì˜ ê³„ì • ë° í™˜ê²½ ì •ë³´ê°€ ë‹´ê¸´ `appliation-aws.yaml`íŒŒì¼ì„ `application.yaml`ì— import ì‹œì¼œë†“ì€ ìƒíƒœ  
    (ì¶”ê°€ ìˆ˜ì • í•„ìš” ì—†ìŒ)


<br><br>

### 3. ì›¹ì†Œì¼“ ì±„íŒ…

- ë¡œì»¬ í…ŒìŠ¤íŠ¸ ì‹œ url ë³€ê²½ í•„ìš”

    (ec2 ë°°í¬ì‹œ ë³€ê²½í•  í•„ìš” ì—†ìŒ)

    1. chat-detail.vue

    ```bash
    frontend
    â””â”€â”€ src
        â””â”€â”€ views
        	â””â”€â”€ chat
        		â””â”€â”€ chat-detail.vue
    ```

    ![image](/uploads/c1592027a60b3bae36be5e85f4827cc1/image.png)

    291, 292ë²ˆ ë¼ì¸ì˜ `url`ë¥¼ í˜„ì¬ í™˜ê²½ì— ë§ëŠ” URIë¡œ ë³€ê²½ì‹œì¼œì£¼ê³ , í•´ë‹¹ í•˜ì§€ ì•ŠëŠ” URIëŠ” ì£¼ì„ì²˜ë¦¬í•œë‹¤.

    - `https://i5a501.p.ssafy.io/api/v1/chat-server` : ë°°í¬ìš©
    - `https://localhost:8081/api/v1/chat-server` : ë¡œì»¬í…ŒìŠ¤íŠ¸ìš©
